<html>
<head>
<script src="../../resources/js-test.js"></script>
<script src="resources/char-encoding-utils.js"></script>
</head>
<body>
<form id="form" method="GET" target="subframe"><input type="text" id="text" name="text"></form>
<iframe id="subframe" name="subframe"></iframe>
<script>


var charsets = new Array;
var unicodes = new Array;
var expectedResults = new Array;

var results = new Object;

var i = 0;


testEncode("UTF-8", "U+00A0", "%C2%A0");

// Unpaired UTF-16 surrogates
testEncode("UTF-8", "0xD800", "%EF%BF%BD"); // U+FFFD (REPLACEMENT CHARACTER)
testEncode("UTF-8", "0xDC00", "%EF%BF%BD"); // U+FFFD (REPLACEMENT CHARACTER)

//Yen symbol in gbk
testEncode('GBK', 'U+00A5', '%A3%A4');
testEncode('gb2312', 'U+00A5', '%A3%A4');
testEncode('GB_2312-80', 'U+00A5', '%A3%A4');
testEncode('EUC-CN', 'U+00A5', '%A3%A4');
//Euro symbol in gbk
testEncode('GBK', 'U+20AC', '%80');
testEncode('gb2312', 'U+20AC', '%80');
testEncode('GB_2312-80', 'U+20AC', '%80');
testEncode('EUC-CN', 'U+20AC', '%80');
//Align GBK with gb18030
// See https://www.w3.org/Bugs/Public/show_bug.cgi?id=28740#c3
testEncode('GBK', 'U+01F9', '%A8%BF');
testEncode('GBK', 'U+1E3F', '%A8%BC');
testEncode('gb18030', 'U+01F9', '%A8%BF');
testEncode('gb18030', 'U+1E3F', '%A8%BC');
testEncode('GBK', 'U+2026', '%A1%AD');
testEncode('GBK', 'U+FF5E', '%A1%AB');
testEncode('gb18030', 'U+2026', '%A1%AD');
testEncode('gb18030', 'U+FF5E', '%A1%AB');
// GBK does not cover these two characters.
testEncode('GBK', 'U+22EF', '%26%238943%3B');
testEncode('GBK', 'U+301C', '%26%2312316%3B');

// Replacement encodings - should encode as UTF-8
testEncode("csiso2022kr", "U+00A0", "%C2%A0");
testEncode("hz-gb-2312", "U+00A0", "%C2%A0");
testEncode("iso-2022-cn", "U+00A0", "%C2%A0");
testEncode("iso-2022-cn-ext", "U+00A0", "%C2%A0");
testEncode("iso-2022-kr", "U+00A0", "%C2%A0");

// Turning on this test causes a download to occur. FIXME: A bug?
// testEncode('UTF-8', 'U+221A', '%E2%88%9A');

if (window.testRunner)
    testRunner.waitUntilDone();
runTest();

</script>
</body>
</html>
